---
import Layout from "../layouts/Layout.astro";
import SectionTitle from "../components/SectionTitle.astro";
import SkewButton from "../components/SkewButton.astro";
---

<Layout title="Contact - Titouan Winkel">
    <!-- Made contact page responsive -->
    <main
        class="container mx-auto px-4 sm:px-6 py-12 sm:py-14 lg:py-16 flex flex-col items-center"
    >
        <div class="w-full max-w-5xl">
            <SectionTitle text="Me contacter" />

            <!-- Contact info at the top -->
            <!-- Made contact info responsive with stacked layout on mobile -->
            <div
                class="mb-6 sm:mb-8 flex flex-col sm:flex-row gap-4 sm:gap-12 text-base sm:text-lg lg:text-xl"
                style="font-family: 'Space Grotesk', sans-serif; font-weight: 500;"
            >
                <p>
                    <span class="font-semibold">Mail :</span>
                    <a
                        href="mailto:titouan.winkel@edu.univ-fcomte.fr"
                        class="text-purple-600 hover:text-purple-800 underline break-all"
                    >
                        titouan.winkel@edu.univ-fcomte.fr
                    </a>
                </p>
                <p>
                    <span class="font-semibold">Téléphone :</span>
                    <a
                        href="tel:+33762708634"
                        class="text-purple-600 hover:text-purple-800 underline"
                    >
                        07 62 70 86 34
                    </a>
                </p>
            </div>

            <!-- Contact form -->
            <!-- Made form responsive -->
            <form
                id="contact-form"
                class="space-y-4 sm:space-y-6"
                method="POST"
            >
                <!-- First row: Prénom and Nom side by side -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                    <div>
                        <input
                            type="text"
                            name="prenom"
                            placeholder="Prénom"
                            required
                            class="w-full px-4 sm:px-6 py-3 sm:py-4 bg-purple-200 border-2 sm:border-3 border-black text-base sm:text-lg"
                            style="font-family: 'Space Grotesk', sans-serif;"
                        />
                    </div>
                    <div>
                        <input
                            type="text"
                            name="nom"
                            placeholder="Nom"
                            required
                            class="w-full px-4 sm:px-6 py-3 sm:py-4 bg-purple-200 border-2 sm:border-3 border-black text-base sm:text-lg"
                            style="font-family: 'Space Grotesk', sans-serif;"
                        />
                    </div>
                </div>

                <input
                    type="hidden"
                    name="access_key"
                    value="b145046a-7b32-4697-84ab-b5387ccd3e7a"
                />
                <input type="hidden" name="redirect" value="false" />

                <!-- Email field -->
                <div>
                    <input
                        type="email"
                        name="email"
                        placeholder="E-mail"
                        required
                        class="w-full px-4 sm:px-6 py-3 sm:py-4 bg-purple-200 border-2 sm:border-3 border-black text-base sm:text-lg"
                        style="font-family: 'Space Grotesk', sans-serif;"
                    />
                </div>

                <!-- Subject field -->
                <div>
                    <input
                        type="text"
                        name="sujet"
                        placeholder="Sujet"
                        required
                        class="w-full px-4 sm:px-6 py-3 sm:py-4 bg-purple-200 border-2 sm:border-3 border-black text-base sm:text-lg"
                        style="font-family: 'Space Grotesk', sans-serif;"
                    />
                </div>

                <!-- Message textarea -->
                <div>
                    <textarea
                        name="message"
                        placeholder="Message"
                        required
                        rows="6"
                        class="w-full px-4 sm:px-6 py-3 sm:py-4 bg-purple-200 border-2 sm:border-3 border-black resize-none text-base sm:text-lg"
                        style="font-family: 'Space Grotesk', sans-serif;"
                    ></textarea>
                </div>

                <!-- Submit button using SkewButton -->
                <div class="flex justify-center pt-4">
                    <SkewButton href="#" text="Envoyer">
                        <button type="submit" class="w-full h-full">
                            Envoyer
                        </button>
                    </SkewButton>
                </div>
            </form>

            <!-- Status message display -->
            <div
                id="form-status"
                class="mt-4 text-center hidden text-sm sm:text-base"
            >
            </div>
        </div>
    </main>
</Layout>

<script>
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const statusDiv = document.getElementById("form-status") as HTMLDivElement;

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const formData = new FormData(form);

        statusDiv.classList.remove("hidden");
        statusDiv.textContent = "Envoi en cours...";
        statusDiv.className = "mt-4 text-center text-purple-600";

        try {
            const response = await fetch("https://api.web3forms.com/submit", {
                method: "POST",
                body: formData,
            });

            const result = await response.json();

            if (result.success) {
                statusDiv.textContent = "Message envoyé avec succès !";
                statusDiv.className =
                    "mt-4 text-center text-green-600 font-semibold";
                form.reset();
            } else {
                statusDiv.textContent =
                    "Erreur lors de l'envoi. Veuillez réessayer.";
                statusDiv.className =
                    "mt-4 text-center text-red-600 font-semibold";
            }
        } catch (error) {
            statusDiv.textContent =
                "Erreur lors de l'envoi du message. Veuillez réessayer.";
            statusDiv.className = "mt-4 text-center text-red-600 font-semibold";
        }
    });
</script>
